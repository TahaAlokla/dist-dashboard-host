"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[561],{561:(P,b,r)=>{r.r(b),r.d(b,{default:()=>$});var e=r(2223),p=r(4755),i=r(9401),x=r(8467),d=r(1217),v=r(787),T=r(3649),B=r(9609),m=r(9114),g=r(1728),Z=r(430),N=r(4285),Q=r(3915),F=r(5226),q=r.n(F),J=r(8505),A=r(3900),y=r(3144),f=r(5787),_=r(2340),w=r(1135),I=r(4004);let k=(()=>{class n{get BalanceCard$(){return this._BalanceCard.asObservable()}constructor(t){this._httpClient=t,this._BalanceCard=new w.X(null)}create_BalanceCard(t){return this._httpClient.post(`${_.N.API_ENDPOINT+f.b.balance_card.create_balance_card}`,{...t})}uploadImage(t){let a=new FormData;a.append("image",t);let s=(new y.LE).set("folder","blance_card");return this._httpClient.post(`${_.N.API_ENDPOINT+f.b.upload_file.upload_file}`,a,{params:s}).pipe((0,I.U)(C=>{if(console.log("Uploading image response: ",C),C.success)return C.data[0]}))}get_balance_card(){return this._httpClient.get(`${_.N.API_ENDPOINT+f.b.balance_card.all_balance_card}`).pipe((0,I.U)(a=>{if(a.code=200){const o=a.data[0];return this._BalanceCard.next(o),o}}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(y.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var c=r(5855);function U(n,l){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",17)(2,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addTransateMode())}),e._uU(3),e.qZA()(),e.BQk()}2&n&&(e.xp6(3),e.hij(" ","Add Translate"," "))}function S(n,l){if(1&n&&(e.TgZ(0,"mat-option",22)(1,"span",23),e._uU(2),e.qZA()()),2&n){const t=l.$implicit;e.Q6J("value",t.lang_code),e.xp6(2),e.Oqu(t.language_name)}}function O(n,l){if(1&n&&(e.ynx(0),e.TgZ(1,"div",19)(2,"mat-form-field",6)(3,"mat-label"),e._uU(4),e.qZA(),e.TgZ(5,"mat-select",20),e.YNc(6,S,3,2,"mat-option",21),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Oqu("Select Language"),e.xp6(1),e.Q6J("formControlName","lang_code"),e.xp6(1),e.Q6J("ngForOf",t.languages)}}function V(n,l){if(1&n&&(e.TgZ(0,"mat-option",22)(1,"span",23),e._uU(2),e.qZA()()),2&n){const t=l.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function M(n,l){if(1&n&&(e.ynx(0),e.TgZ(1,"div",19)(2,"mat-form-field",6)(3,"mat-label"),e._uU(4),e.qZA(),e.TgZ(5,"mat-select",20),e.YNc(6,V,3,2,"mat-option",21),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Oqu("Status"),e.xp6(1),e.Q6J("formControlName","status"),e.xp6(1),e.Q6J("ngForOf",t.statustypes)}}function j(n,l){1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",6)(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"input",24),e.qZA(),e.BQk()),2&n&&(e.xp6(3),e.Oqu("Maximum Limit for normal user "),e.xp6(1),e.Q6J("formControlName","maximum_purchase_limit"))}function E(n,l){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",44)(2,"mat-form-field",45)(3,"mat-label"),e._uU(4),e.qZA(),e._UZ(5,"input",46),e.TgZ(6,"button",47),e.NdJ("click",function(){const s=e.CHM(t).index,h=e.oxw(2);return e.KtG(h.removeAamountsValue(s))}),e._UZ(7,"mat-icon",31),e.qZA()()(),e.BQk()}if(2&n){const t=l.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.Oqu(" Value :"+(t+1)),e.xp6(1),e.Q6J("formControlName","amount"),e.xp6(2),e.Q6J("svgIcon","mat_outline:delete_outline")}}function L(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(o){return e.CHM(t),e.oxw(2).removeAvatar(),e.KtG(o.stopPropagation())}),e._UZ(1,"mat-icon",49),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.BalanceCardForm.disabled),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:trash")}}function G(n,l){1&n&&e._UZ(0,"img",50)}function Y(n,l){if(1&n&&e._UZ(0,"img",51),2&n){const t=e.oxw(2);e.Q6J("src",t.imageSrc,e.LSH)}}function D(n,l){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",25),e.ynx(2,26),e.TgZ(3,"div",27)(4,"div",28)(5,"div",29)(6,"button",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addAamountsValue())}),e._UZ(7,"mat-icon",31),e.qZA(),e.TgZ(8,"span",32),e._uU(9,"Add New Amount Value"),e.qZA()(),e.TgZ(10,"div",33),e.YNc(11,E,8,4,"ng-container",34),e.qZA()()(),e.BQk(),e.ynx(12),e.TgZ(13,"div",35)(14,"p",36),e._uU(15),e.qZA(),e.TgZ(16,"div",37),e.YNc(17,L,2,2,"button",38),e.YNc(18,G,1,0,"img",39),e.YNc(19,Y,1,1,"img",40),e.TgZ(20,"div")(21,"input",41,42),e.NdJ("change",function(){e.CHM(t);const o=e.MAs(23),s=e.oxw();return e.KtG(s.uploadAvatar(o.files))}),e.qZA()(),e.TgZ(24,"button",43),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(22);return e.KtG(o.click())}),e._uU(25),e.qZA()()(),e.BQk(),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();let a;e.xp6(7),e.Q6J("svgIcon","mat_solid:add_box"),e.xp6(4),e.Q6J("ngForOf",null==(a=t.BalanceCardForm.get("amounts"))?null:a.controls),e.xp6(4),e.hij(" ","Gift Card Logo *"," "),e.xp6(2),e.Q6J("ngIf",t.imageSrc),e.xp6(1),e.Q6J("ngIf",!t.imageSrc),e.xp6(1),e.Q6J("ngIf",t.imageSrc),e.xp6(2),e.Q6J("multiple",!1)("disabled",t.BalanceCardForm.disabled)("accept","image/jpeg, image/png"),e.xp6(3),e.Q6J("disabled",t.BalanceCardForm.disabled),e.xp6(1),e.hij(" ","Select Image"," ")}}function K(n,l){1&n&&(e.ynx(0),e.TgZ(1,"button",52),e._uU(2),e.qZA(),e.BQk()),2&n&&(e.xp6(2),e.hij(" ","cance"," "))}function R(n,l){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",53),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.backModeAdd())}),e._uU(2),e.qZA(),e.BQk()}2&n&&(e.xp6(2),e.hij(" ","Back"," "))}function H(n,l){1&n&&e._UZ(0,"mat-progress-spinner",54),2&n&&e.Q6J("diameter",24)("mode","indeterminate")}const u=function(n){return{"border rounded border-warn":n}},$=[{path:"",component:(()=>{class n{constructor(){this.imageSrc=null,this.ImageFile=null,this.isLoading=!0,this.BalanceCard=null,this.mode="add",this.languages=[],this.statustypes=["active","inActive"],this.toast=q().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3}),this._formBuilder=(0,e.f3M)(i.QS),this.destroyRef=(0,e.f3M)(e.ktI),this._blanceService=(0,e.f3M)(k),this.LangTransatedService=(0,e.f3M)(Q.A),this.quillModules={toolbar:[["bold","italic","underline"],[{align:[]},{list:"ordered"},{list:"bullet"}],["clean"]]}}ngOnInit(){this.BalanceCardForm=this._formBuilder.group({card_name:["",[i.kI.required]],card_logo:["",[]],lang_code:["En"],type:["balance_card"],status:["active",[i.kI.required]],card_about:["",[i.kI.required]],maximum_purchase_limit:["",[i.kI.required]],how_to_redeem:["",[i.kI.required]],terms_condition:["",[i.kI.required]],card_description:["",[i.kI.required]],amounts:this._formBuilder.array([])}),this._blanceService.get_balance_card().subscribe(),this._blanceService.BalanceCard$.pipe((0,c.sL)(this.destroyRef),(0,J.b)(t=>{this.BalanceCard=t,console.log("balance card loaded",t),this.BalanceCardForm.patchValue(t),this.imageSrc=this.BalanceCardForm.get("card_logo").value,t?.amounts?(this.clearAamountsValue(),t.amounts.forEach(a=>{this.addAamountsValue(a)})):this.addAamountsValue(),this.isLoading=!1})).subscribe()}addTransateMode(){this.LangTransatedService.getLanguages().pipe((0,c.sL)(this.destroyRef)).subscribe({next:t=>{this.languages=t,this.mode="transate"},error:t=>{this.toast.fire({icon:"error",title:"somthing error !"})},complete:()=>{}})}backModeAdd(){this.mode="add"}addAamountsValue(t){this.BalanceCardForm.get("amounts").push(this.createAamountsValueControl(t))}createAamountsValueControl(t){return this._formBuilder.group({amount:[t?t.amount:"",[i.kI.required]]})}removeAamountsValue(t){const a=this.BalanceCardForm.get("amounts");a.at(t),a.removeAt(t)}clearAamountsValue(){this.BalanceCardForm.get("amounts").clear()}isEditorContentInvalid(t){const a=this.BalanceCardForm.get(t);return a.invalid&&(a.dirty||a.touched)}submit(){if(!this.BalanceCardForm.invalid){if("add"===this.mode&&!this.imageSrc)return void this.toast.fire({icon:"warning",text:"Ensure that there are no blank fields ! "});"add"===this.mode&&this.imageSrc&&this.ImageFile?(this.submitDataWithNewImage(),console.log("submitDataWithNewImage")):"add"===this.mode&&this.imageSrc&&!this.ImageFile?(console.log("run submitWithOriginalImage"),this.submitWithOriginalImage()):"transate"===this.mode&&this.submitWithOriginalImage()}}submitDataWithNewImage(){this.BalanceCardForm.disable(),this._blanceService.uploadImage(this.ImageFile).pipe((0,c.sL)(this.destroyRef),(0,A.w)(a=>{console.log("Uploading image switched ",a),this.BalanceCardForm.get("card_logo").setValue(a);const o={...this.BalanceCardForm.value};return console.log("paylaod: ",o),this._blanceService.create_BalanceCard(o)})).subscribe({next:a=>{this.toast.fire({icon:"success",title:"Success Update BalanceCard"}),this.BalanceCardForm.enable(),this._blanceService.get_balance_card().pipe((0,c.sL)(this.destroyRef)).subscribe()},error:a=>{this.toast.fire({icon:"error",title:a.error?.message}),this.BalanceCardForm.enable(),console.error("Error occurred:",a)}})}submitWithOriginalImage(){this.BalanceCardForm.disable();const t={...this.BalanceCardForm.value};this._blanceService.create_BalanceCard(t).pipe((0,c.sL)(this.destroyRef),(0,A.w)(()=>(this.BalanceCardForm.enable(),this._blanceService.get_balance_card()))).subscribe({next:a=>{this.toast.fire("add"===this.mode?{icon:"success",title:"Success Update BalanceCard"}:{icon:"success",title:"Success Add BalanceCard Translation"})},error:a=>{this.toast.fire({icon:"error",title:"somthing error"}),this.BalanceCardForm.enable()}})}removeAvatar(){this.imageSrc=null,this.ImageFile=null}uploadAvatar(t){if(!t.length)return;const o=t[0];if(!["image/jpeg","image/png"].includes(o.type))return;const s=new FileReader;s.readAsDataURL(o),s.onload=()=>{this.imageSrc=s.result},this.ImageFile=o}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-balance-card"]],standalone:!0,features:[e.jDz],decls:44,vars:45,consts:[[1,"relative","inset-0","min-w-0","overflow-y-auto","p-0","w-full","bg-card","min-h-screen","rounded-md","mb-12"],[1,"flex-auto","pt-5","pb-5","md:px-8","lg:px-12","grid","sm:grid-cols-2","gap-x-6","w-full"],[4,"ngIf"],[1,"sm:col-span-2","px-2","h-full"],[1,"w-full"],[1,"w-full",3,"formGroup"],[1,"fuse-mat-no-subscript","w-full"],["matInput","","placeholder","Gift Card Name",3,"formControlName"],[1,""],[1,"font-semibold","text-default"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],["placeholder","card about",1,"mt-2","w-full",3,"ngClass","required","formControlName","bounds","modules"],[1,"mt-2","w-full",3,"ngClass","required","formControlName","bounds","modules"],[1,"mt-2","w-full",3,"required","ngClass","formControlName","bounds","modules"],[1,"w-full","flex","items-center","justify-center","sm:justify-end","px-6","pt-4","space-x-3"],["type","button","mat-flat-button","","color","primary",1,"px-8",3,"disabled","click"],[3,"diameter","mode",4,"ngIf"],[1,"sm:col-span-2","w-full","flex","justify-end"],["mat-flat-button","","type","button","color","primary",1,"px-8","rounded-lg",3,"click"],[1,"sm:col-span-2"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"ml-3"],["matInput","","type","number","placeholder","Gift Card Name",3,"formControlName"],[1,"grid","sm:grid-cols-2","gap-6","w-full"],["formArrayName","amounts"],[1,"sm:col-span-1"],[1,"flex","flex-col"],[1,"flex","items-center"],["mat-icon-button","","type","button",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"leading-none"],[1,"grid","sm:grid-cols-1","gap-x-4","w-full"],[4,"ngFor","ngForOf"],[1,"sm:col-span-1","flex","flex-col","justify-end","items-end","min-w-70","min-h-50","max-w-70","max-h-max"],[1,"text-xl","font-semibold","my-2","text-default","text-center","block","w-full"],[1,"bg-default","flex","flex-col","justify-center","items-center","px-4","py-4","w-full","max-h-max"],["mat-icon-button","","class","flex items-center justify-center w-10 h-10 rounded-full cursor-pointer hover:bg-hover","matRipple","",3,"disabled","click",4,"ngIf"],["src","assets/images/image-upload.svg","alt","img","srcset","","class","block min-w-70 min-h-40 max-w-70 max-h-40 object-contain",4,"ngIf"],["alt","img","srcset","","class","block min-w-70 min-h-40 max-w-70 max-h-40 object-contain",3,"src",4,"ngIf"],["id","avatar-file-input","type","file",1,"absolute","h-0","w-0","opacity-0","invisible","pointer-events-none",3,"multiple","disabled","accept","change"],["img_banner","","avatarFileInput",""],["mat-flat-button","",1,"block","bg-[#FFF9C4]","text-black","my-3","px-4","py-2",3,"disabled","click"],[1,"sm:col-span-1",3,"formGroupName"],[1,"fuse-mat-no-subscript","w-full","fuse-mat-emphasized-affix"],["type","number","matInput","","placeholder","amount Value",3,"formControlName"],["mat-icon-button","","type","button","matSuffix","",3,"click"],["mat-icon-button","","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover",3,"disabled","click"],[1,"text-red-500",3,"svgIcon"],["src","assets/images/image-upload.svg","alt","img","srcset","",1,"block","min-w-70","min-h-40","max-w-70","max-h-40","object-contain"],["alt","img","srcset","",1,"block","min-w-70","min-h-40","max-w-70","max-h-40","object-contain",3,"src"],["mat-stroked-button",""],["mat-stroked-button","","type","button",3,"click"],[3,"diameter","mode"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,U,4,1,"ng-container",2),e.TgZ(3,"div",3)(4,"div",4)(5,"form",5),e.YNc(6,O,7,3,"ng-container",2),e.ynx(7),e.TgZ(8,"mat-form-field",6)(9,"mat-label"),e._uU(10),e.qZA(),e._UZ(11,"input",7),e.qZA(),e.BQk(),e.YNc(12,M,7,3,"ng-container",2),e.YNc(13,j,5,2,"ng-container",2),e.YNc(14,D,26,11,"ng-container",2),e.ynx(15),e.TgZ(16,"div",8)(17,"mat-label",9),e._uU(18),e.qZA(),e._UZ(19,"span",10)(20,"quill-editor",11),e.qZA(),e.BQk(),e.ynx(21),e.TgZ(22,"mat-label",9),e._uU(23),e.qZA(),e._UZ(24,"span",10)(25,"quill-editor",12),e.BQk(),e.ynx(26),e.TgZ(27,"mat-label",9),e._uU(28),e.qZA(),e._UZ(29,"span",10)(30,"quill-editor",13),e.BQk(),e.ynx(31),e.TgZ(32,"mat-label",9),e._uU(33),e.qZA(),e._UZ(34,"span",10)(35,"quill-editor",13),e.BQk(),e.ynx(36),e.TgZ(37,"div",14),e.YNc(38,K,3,1,"ng-container",2),e.YNc(39,R,3,1,"ng-container",2),e.ynx(40),e.TgZ(41,"button",15),e.NdJ("click",function(){return a.submit()}),e.YNc(42,H,1,2,"mat-progress-spinner",16),e._uU(43),e.qZA(),e.BQk(),e.qZA(),e.BQk(),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("ngIf","add"==a.mode),e.xp6(3),e.Q6J("formGroup",a.BalanceCardForm),e.xp6(1),e.Q6J("ngIf","transate"==a.mode),e.xp6(4),e.Oqu("Gift Card Name "),e.xp6(1),e.Q6J("formControlName","card_name"),e.xp6(1),e.Q6J("ngIf","add"==a.mode),e.xp6(1),e.Q6J("ngIf","add"==a.mode),e.xp6(1),e.Q6J("ngIf","add"==a.mode),e.xp6(4),e.Oqu("Card About "),e.xp6(2),e.Q6J("ngClass",e.VKq(37,u,a.isEditorContentInvalid("card_about")))("required",!0)("formControlName","card_about")("bounds","self")("modules",a.quillModules),e.xp6(3),e.Oqu("Description "),e.xp6(2),e.Q6J("ngClass",e.VKq(39,u,a.isEditorContentInvalid("card_description")))("required",!0)("formControlName","card_description")("bounds","self")("modules",a.quillModules),e.xp6(3),e.Oqu("terms condition"),e.xp6(2),e.Q6J("required",!0)("ngClass",e.VKq(41,u,a.isEditorContentInvalid("terms_condition")))("formControlName","terms_condition")("bounds","self")("modules",a.quillModules),e.xp6(3),e.Oqu("how to redeem"),e.xp6(2),e.Q6J("required",!0)("ngClass",e.VKq(43,u,a.isEditorContentInvalid("how_to_redeem")))("formControlName","how_to_redeem")("bounds","self")("modules",a.quillModules),e.xp6(3),e.Q6J("ngIf","add"===a.mode),e.xp6(1),e.Q6J("ngIf","transate"===a.mode),e.xp6(2),e.Q6J("disabled",a.BalanceCardForm.invalid||!a.imageSrc),e.xp6(1),e.Q6J("ngIf",a.BalanceCardForm.disabled),e.xp6(1),e.hij(" ","Save"," "))},dependencies:[p.O5,p.ax,p.mk,Z.Ps,Z.Hw,g.ot,g.lW,g.RK,m.lN,m.KE,m.hX,m.R9,i.u5,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.Q7,i.UX,i.sg,i.u,i.x0,i.CE,B.c,B.Nt,d.si,d.wG,T.AV,v.LD,v.gD,d.ey,d.Ng,x.Cq,x.Ou,N.g6]}),n})()}]}}]);