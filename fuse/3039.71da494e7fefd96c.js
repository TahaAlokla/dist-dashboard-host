"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3039],{3039:(Ee,E,a)=>{a.r(E),a.d(E,{default:()=>Ie});var e=a(2223),D=a(4755),S=a(8467),f=a(1217),O=a(787),Z=a(9609),l=a(9401),_=a(9114),M=a(1728),B=a(430),q=a(5226),V=a.n(q),A=a(418),y=a(7579),v=a(1135),Q=a(5191),H=a(9646),C=a(2722),p=a(1692),$=a(8930);class K{constructor(){this.expansionModel=new A.Ov(!0)}toggle(r){this.expansionModel.toggle(this._trackByValue(r))}expand(r){this.expansionModel.select(this._trackByValue(r))}collapse(r){this.expansionModel.deselect(this._trackByValue(r))}isExpanded(r){return this.expansionModel.isSelected(this._trackByValue(r))}toggleDescendants(r){this.expansionModel.isSelected(this._trackByValue(r))?this.collapseDescendants(r):this.expandDescendants(r)}collapseAll(){this.expansionModel.clear()}expandDescendants(r){let t=[r];t.push(...this.getDescendants(r)),this.expansionModel.select(...t.map(o=>this._trackByValue(o)))}collapseDescendants(r){let t=[r];t.push(...this.getDescendants(r)),this.expansionModel.deselect(...t.map(o=>this._trackByValue(o)))}_trackByValue(r){return this.trackBy?this.trackBy(r):r}}class X extends K{constructor(r,t,o){super(),this.getLevel=r,this.isExpandable=t,this.options=o,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(r){const o=[];for(let i=this.dataNodes.indexOf(r)+1;i<this.dataNodes.length&&this.getLevel(r)<this.getLevel(this.dataNodes[i]);i++)o.push(this.dataNodes[i]);return o}expandAll(){this.expansionModel.select(...this.dataNodes.map(r=>this._trackByValue(r)))}}const x=new e.OlP("CDK_TREE_NODE_OUTLET_NODE");let m=(()=>{class n{constructor(t,o){this.viewContainer=t,this._node=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(x,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkTreeNodeOutlet",""]]}),n})();class z{constructor(r){this.$implicit=r}}let T=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),n})(),h=(()=>{class n{get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}constructor(t,o){this._differs=t,this._changeDetectorRef=o,this._onDestroy=new y.x,this._levels=new Map,this.viewChange=new v.X({start:0,end:Number.MAX_VALUE})}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const t=this._nodeDefs.filter(o=>!o.when);this._defaultNodeDef=t[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(t){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),t||this._nodeOutlet.viewContainer.clear(),this._dataSource=t,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let t;(0,A.Z9)(this._dataSource)?t=this._dataSource.connect(this):(0,Q.b)(this._dataSource)?t=this._dataSource:Array.isArray(this._dataSource)&&(t=(0,H.of)(this._dataSource)),t&&(this._dataSubscription=t.pipe((0,C.R)(this._onDestroy)).subscribe(o=>this.renderNodeChanges(o)))}renderNodeChanges(t,o=this._dataDiffer,i=this._nodeOutlet.viewContainer,s){const d=o.diff(t);d&&(d.forEachOperation((c,g,N)=>{if(null==c.previousIndex)this.insertNode(t[N],N,i,s);else if(null==N)i.remove(g),this._levels.delete(c.item);else{const we=i.get(g);i.move(we,N)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(t,o){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(s=>s.when&&s.when(o,t))||this._defaultNodeDef}insertNode(t,o,i,s){const d=this._getNodeDef(t,o),c=new z(t);c.level=this.treeControl.getLevel?this.treeControl.getLevel(t):typeof s<"u"&&this._levels.has(s)?this._levels.get(s)+1:0,this._levels.set(t,c.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(d.template,c,o),u.mostRecentTreeNode&&(u.mostRecentTreeNode.data=t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.ZZ4),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["cdk-tree"]],contentQueries:function(t,o,i){if(1&t&&e.Suo(i,T,5),2&t){let s;e.iGM(s=e.CRH())&&(o._nodeDefs=s)}},viewQuery:function(t,o){if(1&t&&e.Gf(m,7),2&t){let i;e.iGM(i=e.CRH())&&(o._nodeOutlet=i.first)}},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,o){1&t&&e.GkF(0,0)},dependencies:[m],encapsulation:2}),n})(),u=(()=>{class n{get role(){return"treeitem"}set role(t){this._elementRef.nativeElement.setAttribute("role",t)}get data(){return this._data}set data(t){t!==this._data&&(this._data=t,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):this._parentNodeAriaLevel}constructor(t,o){this._elementRef=t,this._tree=o,this._destroyed=new y.x,this._dataChanges=new y.x,n.mostRecentTreeNode=this,this.role="treeitem"}ngOnInit(){this._parentNodeAriaLevel=function W(n){let r=n.parentElement;for(;r&&!ee(r);)r=r.parentElement;return r?r.classList.contains("cdk-nested-tree-node")?(0,p.su)(r.getAttribute("aria-level")):0:-1}(this._elementRef.nativeElement),this._elementRef.nativeElement.setAttribute("aria-level",`${this.level+1}`)}ngOnDestroy(){n.mostRecentTreeNode===this&&(n.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return n.mostRecentTreeNode=null,n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(h))},n.\u0275dir=e.lG2({type:n,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:1,hostBindings:function(t,o){2&t&&e.uIk("aria-expanded",o.isExpanded)},inputs:{role:"role"},exportAs:["cdkTreeNode"]}),n})();function ee(n){const r=n.classList;return!(!r?.contains("cdk-nested-tree-node")&&!r?.contains("cdk-tree"))}const te=/([A-Za-z%]+)$/;let F=(()=>{class n{get level(){return this._level}set level(t){this._setLevelInput(t)}get indent(){return this._indent}set indent(t){this._setIndentInput(t)}constructor(t,o,i,s){this._treeNode=t,this._tree=o,this._element=i,this._dir=s,this._destroyed=new y.x,this.indentUnits="px",this._indent=40,this._setPadding(),s&&s.change.pipe((0,C.R)(this._destroyed)).subscribe(()=>this._setPadding(!0)),t._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){const t=this._treeNode.data&&this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._treeNode.data):null,o=null==this._level?t:this._level;return"number"==typeof o?`${o*this._indent}${this.indentUnits}`:null}_setPadding(t=!1){const o=this._paddingIndent();if(o!==this._currentPadding||t){const i=this._element.nativeElement,s=this._dir&&"rtl"===this._dir.value?"paddingRight":"paddingLeft",d="paddingLeft"===s?"paddingRight":"paddingLeft";i.style[s]=o||"",i.style[d]="",this._currentPadding=o}}_setLevelInput(t){this._level=(0,p.su)(t,null),this._setPadding()}_setIndentInput(t){let o=t,i="px";if("string"==typeof t){const s=t.split(te);o=s[0],i=s[1]||i}this.indentUnits=i,this._indent=(0,p.su)(o),this._setPadding()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u),e.Y36(h),e.Y36(e.SBq),e.Y36($.Is,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:["cdkTreeNodePadding","level"],indent:["cdkTreeNodePaddingIndent","indent"]}}),n})(),I=(()=>{class n{get recursive(){return this._recursive}set recursive(t){this._recursive=(0,p.Ig)(t)}constructor(t,o){this._tree=t,this._treeNode=o,this._recursive=!1}_toggle(t){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),t.stopPropagation()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h),e.Y36(u))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(t,o){1&t&&e.NdJ("click",function(s){return o._toggle(s)})},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),n})(),ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({}),n})();var oe=a(6451),re=a(5698),ie=a(4004);const se=(0,f.sb)((0,f.Id)(u));let R=(()=>{class n extends se{constructor(t,o,i){super(t,o),this.tabIndex=Number(i)||0}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(h),e.$8M("tabindex"))},n.\u0275dir=e.lG2({type:n,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],inputs:{role:"role",disabled:"disabled",tabIndex:"tabIndex"},exportAs:["matTreeNode"],features:[e._Bn([{provide:u,useExisting:n}]),e.qOj]}),n})(),J=(()=>{class n extends T{}return n.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(n)))(o||n)}}(),n.\u0275dir=e.lG2({type:n,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[e._Bn([{provide:T,useExisting:n}]),e.qOj]}),n})(),P=(()=>{class n extends F{get level(){return this._level}set level(t){this._setLevelInput(t)}get indent(){return this._indent}set indent(t){this._setIndentInput(t)}}return n.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(n)))(o||n)}}(),n.\u0275dir=e.lG2({type:n,selectors:[["","matTreeNodePadding",""]],inputs:{level:["matTreeNodePadding","level"],indent:["matTreeNodePaddingIndent","indent"]},features:[e._Bn([{provide:F,useExisting:n}]),e.qOj]}),n})(),w=(()=>{class n{constructor(t,o){this.viewContainer=t,this._node=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(x,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","matTreeNodeOutlet",""]],features:[e._Bn([{provide:m,useExisting:n}])]}),n})(),Y=(()=>{class n extends h{constructor(){super(...arguments),this._nodeOutlet=void 0}}return n.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(n)))(o||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["mat-tree"]],viewQuery:function(t,o){if(1&t&&e.Gf(w,7),2&t){let i;e.iGM(i=e.CRH())&&(o._nodeOutlet=i.first)}},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[e._Bn([{provide:h,useExisting:n}]),e.qOj],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(t,o){1&t&&e.GkF(0,0)},dependencies:[w],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}"],encapsulation:2}),n})(),U=(()=>{class n extends I{}return n.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(n)))(o||n)}}(),n.\u0275dir=e.lG2({type:n,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[e._Bn([{provide:I,useExisting:n}]),e.qOj]}),n})(),de=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[ne,f.BQ,f.BQ]}),n})();class ce{constructor(r,t,o,i){this.transformFunction=r,this.getLevel=t,this.isExpandable=o,this.getChildren=i}_flattenNode(r,t,o,i){const s=this.transformFunction(r,t);if(o.push(s),this.isExpandable(s)){const d=this.getChildren(r);d&&(Array.isArray(d)?this._flattenChildren(d,t,o,i):d.pipe((0,re.q)(1)).subscribe(c=>{this._flattenChildren(c,t,o,i)}))}return o}_flattenChildren(r,t,o,i){r.forEach((s,d)=>{let c=i.slice();c.push(d!=r.length-1),this._flattenNode(s,t+1,o,c)})}flattenNodes(r){let t=[];return r.forEach(o=>this._flattenNode(o,0,t,[])),t}expandFlattenedNodes(r,t){let o=[],i=[];return i[0]=!0,r.forEach(s=>{let d=!0;for(let c=0;c<=this.getLevel(s);c++)d=d&&i[c];d&&o.push(s),this.isExpandable(s)&&(i[this.getLevel(s)+1]=t.isExpanded(s))}),o}}class le extends A.o2{get data(){return this._data.value}set data(r){this._data.next(r),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}constructor(r,t,o){super(),this._treeControl=r,this._treeFlattener=t,this._flattenedData=new v.X([]),this._expandedData=new v.X([]),this._data=new v.X([]),o&&(this.data=o)}connect(r){return(0,oe.T)(r.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe((0,ie.U)(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}}var ue=a(3979),b=a(5855),ge=a(5684),j=a(8505),he=a(262),L=a(3900),G=a(3649);function fe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.addSubCategory(i))}),e._UZ(1,"mat-icon",25),e.qZA()}2&n&&e.Q6J("matTooltipPosition","above")}function pe(n,r){1&n&&(e.TgZ(0,"button",26),e._UZ(1,"mat-icon",27),e.qZA())}function me(n,r){if(1&n&&(e.TgZ(0,"mat-tree-node",21)(1,"div",3),e.YNc(2,fe,2,1,"button",22),e.YNc(3,pe,2,0,"button",23),e.TgZ(4,"span"),e._uU(5),e.qZA()()()),2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngIf","main"===t.type),e.xp6(1),e.Q6J("ngIf","sub"===t.type),e.xp6(1),e.ekj("font-semibold","main"===t.type),e.xp6(1),e.Oqu(t.name)}}function _e(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-tree-node",28)(1,"button",24),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.addSubCategory(s))}),e._UZ(2,"mat-icon",25),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("matTooltipPosition","above"),e.xp6(2),e.ekj("font-semibold","main"===t.type),e.xp6(1),e.Oqu(t.name)}}function ye(n,r){1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n&&(e.xp6(1),e.hij(" ","Add Main Category "," "))}function ve(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.AsE(" ","Create sub category for "," ",t.categoryForm.get("main_category").value," ")}}function Ce(n,r){1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",15)(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"input",29,30),e.qZA(),e.BQk()),2&n&&(e.xp6(3),e.Oqu("Main Category Name"),e.xp6(1),e.Q6J("formControlName","main_category"))}function xe(n,r){if(1&n&&(e.TgZ(0,"mat-option",31)(1,"span",32),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function Te(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(i){return e.CHM(t),e.oxw(2).removeAvatar(),e.KtG(i.stopPropagation())}),e._UZ(1,"mat-icon",43),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.categoryForm.disabled),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:trash")}}function be(n,r){1&n&&e._UZ(0,"img",44)}function Ne(n,r){if(1&n&&e._UZ(0,"img",45),2&n){const t=e.oxw(2);e.Q6J("src",t.imageSrc,e.LSH)}}function De(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33)(2,"p",34),e._uU(3),e.qZA(),e.TgZ(4,"div",35),e.YNc(5,Te,2,2,"button",36),e.YNc(6,be,1,0,"img",37),e.YNc(7,Ne,1,1,"img",38),e.TgZ(8,"div")(9,"input",39,40),e.NdJ("change",function(){e.CHM(t);const i=e.MAs(11),s=e.oxw();return e.KtG(s.uploadAvatar(i.files))}),e.qZA()(),e.TgZ(12,"button",41),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(10);return e.KtG(i.click())}),e._uU(13),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(" ","Sub Category Image *"," "),e.xp6(2),e.Q6J("ngIf",t.imageSrc),e.xp6(1),e.Q6J("ngIf",!t.imageSrc),e.xp6(1),e.Q6J("ngIf",t.imageSrc),e.xp6(2),e.Q6J("multiple",!1)("disabled",t.categoryForm.disabled)("accept","image/jpeg, image/png"),e.xp6(3),e.Q6J("disabled",t.categoryForm.disabled),e.xp6(1),e.hij(" ","Select Image"," ")}}function Me(n,r){1&n&&e._UZ(0,"mat-progress-spinner",48),2&n&&e.Q6J("diameter",24)("mode","indeterminate")}function Ae(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.YNc(2,Me,1,2,"mat-progress-spinner",47),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.categoryForm.invalid),e.xp6(1),e.Q6J("ngIf",t.categoryForm.disabled),e.xp6(1),e.hij(" ","Save"," ")}}function ke(n,r){1&n&&e._UZ(0,"mat-progress-spinner",48),2&n&&e.Q6J("diameter",24)("mode","indeterminate")}function Fe(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.YNc(2,ke,1,2,"mat-progress-spinner",47),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.categoryForm.invalid||!t.imageSrc),e.xp6(1),e.Q6J("ngIf",t.categoryForm.disabled),e.xp6(1),e.hij(" ","Save"," ")}}const Ie=[{path:"",component:(()=>{class n{constructor(){this.imageSrc=null,this.ImageFile=null,this.TREE_DATA=[],this._transformer=(t,o)=>({expandable:!!t.subs&&t.subs.length>0,name:t.category_name,level:o,type:t.category_type,id_main_category:t._id}),this.treeControl=new X(t=>t.level,t=>t.expandable),this.treeFlattener=new ce(this._transformer,t=>t.level,t=>t.expandable,t=>t.subs),this.dataSource=new le(this.treeControl,this.treeFlattener),this.hasChild=(t,o)=>o.expandable,this.statustypes=["active","inActive"],this.mode="add-main",this.categories=[],this.category=null,this.toast=V().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3}),this._formBuilder=(0,e.f3M)(l.QS),this.destroyRef=(0,e.f3M)(e.ktI),this._CategoriesService=(0,e.f3M)(ue.G),this.location=(0,e.f3M)(D.Ye),this.dataSource.data=this.TREE_DATA}ngOnInit(){this._CategoriesService.getTreeCategories().subscribe(t=>{}),this._CategoriesService.categories$.pipe((0,ge.T)(1),(0,b.sL)(this.destroyRef),(0,j.b)(t=>{console.log("loading data !",t),this.categories=t,this.TREE_DATA=t,this.dataSource.data=t,this.treeControl.expandAll()})).subscribe(),this.categoryForm=this._formBuilder.group({category_name:["",[l.kI.required]],status:["active",[l.kI.required]],category_type:["main",[l.kI.required]],image:[]})}submit(){if(this.categoryForm.invalid)return;const t={...this.categoryForm.value};console.log("paylaod: ",t),"add-main"==this.mode?this.add_main_Category(t):"add-subcategory"==this.mode&&this.submit_add_subCategory()}addSubCategory(t){this.categoryForm.contains("main_category")?this.categoryForm.get("main_category").setValue(t.name):this.categoryForm.addControl("main_category",new l.NI(t.name)),this.categoryForm.contains("category_id")?this.categoryForm.get("category_id").setValue(t.id_main_category):this.categoryForm.addControl("category_id",new l.NI(t.id_main_category)),this.categoryForm.get("main_category").disable(),this.categoryForm.get("category_type").setValue("sub"),this.mode="add-subcategory",console.log("node add sub category",t);const o={...this.categoryForm.value};console.log("node add sun category paylaod",o)}addMainCategory(){this.mode="add-main",this.categoryForm=this._formBuilder.group({category_name:["",[l.kI.required]],status:["active",[l.kI.required]],category_type:["main",[l.kI.required]],image:[]})}add_main_Category(t){this.categoryForm.disable(),this._CategoriesService.create_category(t).pipe((0,b.sL)(this.destroyRef),(0,j.b)(o=>{(o.code=200)?(this.toast.fire({icon:"success",title:"Success Add Main Category"}),this.categoryForm.enable(),this.categoryForm.get("category_name").reset()):(this.toast.fire({icon:"error",title:"somthing error"}),this.categoryForm.enable())}),(0,he.K)(o=>(console.log("error",o.error.message),this.toast.fire({icon:"error",title:o.error.message}),this.categoryForm.enable(),o)),(0,L.w)(()=>this._CategoriesService.getTreeCategories())).subscribe()}submit_add_subCategory(){!this.categoryForm.invalid&&this.imageSrc&&(this.categoryForm.disable(),this._CategoriesService.uploadImage(this.ImageFile).pipe((0,b.sL)(this.destroyRef),(0,L.w)(o=>{console.log("Uploading image switched ",o),this.categoryForm.get("image").setValue(o);const i={...this.categoryForm.value};return console.log("paylaod: ",i),delete i.main_category,console.log("paylaod: ",i),this._CategoriesService.create_category(i)})).subscribe({next:o=>{console.log("success add category",o),this.toast.fire({icon:"success",title:"Success Add Sub Category"}),this._CategoriesService.getTreeCategories().pipe((0,b.sL)(this.destroyRef)).subscribe(),this.categoryForm.enable(),this.categoryForm.reset()},error:o=>{console.log("error:",o),this.toast.fire({icon:"error",title:o.error?.message}),this.categoryForm.enable()}}))}buildTreeCategory(t){const o=new Map,i=new Set;t.forEach(d=>{const c=d?.category_id?._id;if(c)console.log("categoryId",c),o.has(c)||(o.set(c,{...d.category_id,subs:[]}),i.add(c)),o.get(c).subs.push(d),i.delete(c);else{const g=d._id;console.log("test category",o.has(g)),console.log("test category",g),o.has(g)||(o.set(g,{...d}),i.add(g))}});const s=Array.from(o.values());return console.log(s),s}removeAvatar(){this.imageSrc=null,this.ImageFile=null}uploadAvatar(t){if(!t.length)return;const i=t[0];if(!["image/jpeg","image/png"].includes(i.type))return;const s=new FileReader;s.readAsDataURL(i),s.onload=()=>{this.imageSrc=s.result},this.ImageFile=i}NavigationBack(){this.location.back()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-category"]],standalone:!0,features:[e.jDz],decls:39,vars:17,consts:[[1,"relative","inset-0","min-w-0","overflow-y-auto","p-1","w-full"],[1,"flex-auto","pt-9","pb-9","md:px-8","lg:px-12","grid","sm:grid-cols-3","gap-6","w-full"],[1,"sm:col-span-1","px-8","py-12","h-full","bg-card"],[1,"w-full"],["mat-flat-button","",1,"bg-primary","rounded-sm",3,"click"],["svgIcon","heroicons_solid:folder",1,"icon-size-4"],[1,"px-2","font-semibold"],["isExpanded","true",1,"border-l",3,"dataSource","treeControl"],["matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"sm:col-span-2","bg-card","px-8","py-1","rounded-md"],[1,"w-full","mt-8","mb-4","pb-4",3,"formGroup"],[1,"text-xl","md:text-3xl","font-bold","tracking-tight","leading-7","sm:leading-10","truncate"],[4,"ngIf"],[1,"flex","flex-col","justify-center"],[1,"fuse-mat-no-subscript","w-full"],["matInput","","placeholder","Product category_name",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","justify-center","sm:justify-end","px-2","pt-4","space-x-3","border-t"],["mat-stroked-button","",3,"click"],["matTreeNodePadding",""],["mat-icon-button","","matTooltip","add sub category",3,"matTooltipPosition","click",4,"ngIf"],["mat-icon-button","",4,"ngIf"],["mat-icon-button","","matTooltip","add sub category",3,"matTooltipPosition","click"],["svgIcon","mat_solid:create_new_folder",1,"icon-size-4"],["mat-icon-button",""],["svgIcon","heroicons_outline:folder-minus",1,"icon-size-4"],["matTreeNodeToggle","","matTreeNodePadding",""],["matInput","","readonly","",3,"formControlName"],["main_category_name",""],[3,"value"],[1,"ml-3"],[1,"w-full","flex","flex-row","justify-between","items-start","border-2","rounded-md","p-4","my-2"],[1,"text-base","font-normal","my-2","text-default"],[1,"bg-default","flex","flex-col","justify-center","items-center","px-8","py-8"],["mat-icon-button","","class","flex items-center justify-center w-10 h-10 rounded-full cursor-pointer hover:bg-hover","matRipple","",3,"disabled","click",4,"ngIf"],["src","assets/images/image-upload.svg","alt","img","srcset","","class","block min-w-70 min-h-50 max-w-70 max-h-50 object-fill",4,"ngIf"],["alt","img","srcset","","class","block min-w-70 min-h-50 max-w-70 max-h-50 object-fill",3,"src",4,"ngIf"],["id","avatar-file-input","type","file",1,"absolute","h-0","w-0","opacity-0","invisible","pointer-events-none",3,"multiple","disabled","accept","change"],["img_banner","","avatarFileInput",""],["mat-flat-button","",1,"block","bg-[#FFF9C4]","text-black","my-3","px-4","py-2",3,"disabled","click"],["mat-icon-button","","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover",3,"disabled","click"],[1,"text-red-500",3,"svgIcon"],["src","assets/images/image-upload.svg","alt","img","srcset","",1,"block","min-w-70","min-h-50","max-w-70","max-h-50","object-fill"],["alt","img","srcset","",1,"block","min-w-70","min-h-50","max-w-70","max-h-50","object-fill",3,"src"],["mat-flat-button","","color","primary",1,"px-8",3,"disabled","click"],[3,"diameter","mode",4,"ngIf"],[3,"diameter","mode"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),e.NdJ("click",function(){return o.addMainCategory()}),e._UZ(5,"mat-icon",5),e.TgZ(6,"span",6),e._uU(7),e.qZA()()(),e.TgZ(8,"mat-tree",7),e.YNc(9,me,6,5,"mat-tree-node",8),e.YNc(10,_e,5,4,"mat-tree-node",9),e.qZA()(),e.TgZ(11,"div",10)(12,"div",3)(13,"form",11)(14,"div")(15,"h2",12),e.YNc(16,ye,2,1,"ng-container",13),e.YNc(17,ve,2,2,"ng-container",13),e.qZA()(),e.TgZ(18,"div",14),e.YNc(19,Ce,6,2,"ng-container",13),e.TgZ(20,"mat-form-field",15)(21,"mat-label"),e._uU(22),e.qZA(),e._UZ(23,"input",16),e.qZA(),e.TgZ(24,"mat-form-field",3)(25,"mat-label"),e._uU(26),e.qZA(),e.TgZ(27,"mat-select",17),e.YNc(28,xe,3,2,"mat-option",18),e.qZA(),e.TgZ(29,"mat-hint"),e._uU(30,"Active the category"),e.qZA()(),e.YNc(31,De,14,9,"ng-container",13),e.qZA()(),e.ynx(32),e.TgZ(33,"div",19),e.ynx(34),e.TgZ(35,"button",20),e.NdJ("click",function(){return o.categoryForm.reset(),o.NavigationBack()}),e._uU(36),e.qZA(),e.BQk(),e.YNc(37,Ae,4,3,"ng-container",13),e.YNc(38,Fe,4,3,"ng-container",13),e.qZA(),e.BQk(),e.qZA()()()()),2&t&&(e.xp6(7),e.hij(" ","Add Main Category"," "),e.xp6(1),e.Q6J("dataSource",o.dataSource)("treeControl",o.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",o.hasChild),e.xp6(3),e.Q6J("formGroup",o.categoryForm),e.xp6(3),e.Q6J("ngIf","add-main"==o.mode),e.xp6(1),e.Q6J("ngIf","add-subcategory"==o.mode),e.xp6(2),e.Q6J("ngIf","add-subcategory"==o.mode),e.xp6(3),e.Oqu("Category Name"),e.xp6(1),e.Q6J("formControlName","category_name"),e.xp6(3),e.Oqu("Status"),e.xp6(1),e.Q6J("formControlName","status"),e.xp6(1),e.Q6J("ngForOf",o.statustypes),e.xp6(3),e.Q6J("ngIf","add-subcategory"==o.mode),e.xp6(5),e.hij(" ","cance"," "),e.xp6(1),e.Q6J("ngIf","add-main"===o.mode),e.xp6(1),e.Q6J("ngIf","add-subcategory"===o.mode))},dependencies:[D.O5,D.ax,B.Ps,B.Hw,M.ot,M.lW,M.RK,_.lN,_.KE,_.hX,_.bx,l.UX,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,Z.c,Z.Nt,f.si,f.wG,G.AV,G.gM,O.LD,O.gD,f.ey,f.Ng,de,J,P,U,Y,R,S.Cq,S.Ou]}),n})()}]}}]);